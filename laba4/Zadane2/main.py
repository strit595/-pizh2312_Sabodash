from order_module import Заказ, ExtendedOrder

def main():
    print("Тестирование класса Заказ\n")

    # Создание объекта
    заказ1 = Заказ([("Пицца", 500), ("Кола", 100)])
    print(f"Создан заказ:\n{заказ1}")

    # Добавление товара через __call__
    print(заказ1("Хлеб", 50))
    print(f"После добавления товара:\n{заказ1}")

    # Удаление товара
    заказ1.удалить_товар(0)
    print(f"После удаления первого товара:\n{заказ1}")

    # Сложение заказов
    заказ2 = Заказ([("Бургер", 300)])
    заказ3 = заказ1 + заказ2
    print(f"Сумма заказов:\n{заказ3}")

    # Вычитание заказов
    заказ4 = заказ3 - заказ2
    print(f"Разница заказов:\n{заказ4}")

    # Сравнение
    print(f"заказ1 == заказ4: {заказ1 == заказ4}")

    # Создание из строки
    str_order = """Заказ от 2025-05-18 14:30
Статус: оплачен
- Кола (100 руб.)
- Хлеб (50 руб.)
Общая стоимость: 150 руб."""
    заказ5 = Заказ.from_string(str_order)
    print(f"Создан из строки:\n{заказ5}")

    # Сохранение и загрузка
    заказ1.save("order.json")
    заказ6 = Заказ()
    заказ6.load("order.json")
    print(f"Загружен из файла:\n{заказ6}")

    # Наследование
    ext_order = ExtendedOrder([("Пицца", 500)], скидка=10)
    print(f"Расширенный заказ:\n{ext_order}")
    print(f"Стоимость с учётом скидки: {ext_order.рассчитать_стоимость()} руб.")

if __name__ == "__main__":
    main()